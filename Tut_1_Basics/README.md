# Tutorial: Creating a Simple Makefile

A Makefile is a powerful tool that aids in building and managing projects in languages like C and C++. It automates the process of compiling and linking, thus reducing manual work and chances of errors. In this tutorial, we will guide you through the process of creating a simple Makefile.

## Understanding Makefile Syntax

Before creating a Makefile, let's understand its basic syntax:

```makefile
target: prerequisites
	[TAB] recipe
	[TAB] ...
```

- **target**: It's typically the name of the file that is generated by a program (like a `.o`, `.out`, or executable file). It could also be the name of an action, like 'clean'.
- **prerequisites**: These are files that the target depends on. They're also referred to as dependencies. A target often depends on several files.
- **recipe**: These are actions that `make` will execute in order to update the target. Recipes must be indented by a tab, not spaces.

## Important Remarks

- By convention, variables' names in a Makefile are written in upper-case form. For example, `CC = gcc`.
- A variable can be accessed using `${VAR}` or `$(VAR)` syntax.
- If no target is specified, `make` defaults to the first target in the Makefile.
- Each recipe line is executed in a separate sub-shell environment. So a command like `cd newdir` won't affect the next lines.

## How Make Utilizes the Timestamp of Files

`make` checks the timestamp of the target and its prerequisites. If a prerequisite has a newer timestamp than the target (indicating that the prerequisite has changed since the target was last built), `make` rebuilds the target.

## Phony Targets

A phony target is a target that's not associated with a file. For example, 'clean' is a phony target. The recipe associated with it will always be executed if the phony target is the argument to `make`.

## Sample Makefile

Here's an example of a simple Makefile that compiles a program from `main.c` and `module.c` and then links the resulting object files:

```makefile
all: main.o module.o
	gcc -I. main.o module.o -o app.out

main.o: main.c
	gcc -I. -c main.c 

module.o: module.c module.h
	gcc -I. -c module.c

clean:
	rm -rf *.o
	rm -rf *.out
```

In this Makefile:

- `all` is the default target. Running `make` will execute the recipes for `all`.
- The `all` target depends on `main.o` and `module.o`. So if either of these files change, `make` will recompile them and link them into `app.out`.
- The `main.o` and `module.o` targets each depend on their respective source files.
- The `clean` target removes all `.o` and `.out` files in the directory. It's a phony target, as 'clean' isn't a file.

With this Makefile, you can compile your program by running `make`, and clean up the directory by running `make clean`. This simplifies the process of building and managing your C project.
